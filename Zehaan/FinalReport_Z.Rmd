---
title: "MTH209PROJECT"
author: "Zehaan Naik, Aditya V, Viral Chitlangia"
date: "2024-04-02"
output:
  html_document:
    df_print: paged
---

### Introduction

The will to end one's life is commonly believed to stem from various factors such as financial stability, health issues, physical environment, etc. One can easily find multiple data sets on the internet that accurately report the number of suicide cases reported for various prominent cities around the globe and their correlation with numerous factors such as GDP per capita and cleanliness index. These observations give us an objective understanding of these intuitive relations we wish to explore.

The happiness index measures content among the residents of various world countries. This metric is calculated as a function of multiple parameters such as average life expectancy, family income, family size, etc. Various agencies differently model this index, but it heuristically represents the general content with life that people feel in places around the world.

### Aim

With an intuitively expected relationship between suicides and happiness, this report aims to analyze and establish this intuition based on objective metrics and actual world observations.We also aim to compare the trends between the Urban Bliss Index, calculated based on objective parameters, and the World Happiness Index, curated based on extensive surveys.

### Data Analysis

We primarily use three data sets for all our analysis. Namely:

-   [**Suicide Rates for Prominent Countries (1990-2015)**](https://www.kaggle.com/datasets/ahmadalqawasmeh/suicide-data)

    ```{r, echo=FALSE}

    data.suicides <- read.csv("suicide_cleaned.csv")
    head(data.suicides)
    ```

-   [**2024 Urban Bliss Index (2024-2027)**](https://www.kaggle.com/datasets/willianoliveiragibin/2024-urban-bliss-index)

    ```{r, echo=FALSE}

    data.urban.bliss <- read.csv("- train US new.csv")
    head(data.urban.bliss)
    ```

-   [**World Happiness Report**](https://www.kaggle.com/datasets/unsdsn/world-happiness)

    ```{r, echo=FALSE}

    data.happiness <- read.csv("Happiness_cleaned.csv")
    head(data.happiness)
    ```

(Source: Kaggle Datasets)

### Analysis of the Suicide Data 

##### Claim 1: Suicide Rates and Per-Capita Income

For various continents, let's analyse the impact of GDP per capita on the suicide rates of the country. We do this to substantiate our intuition that financial stability in a region has a direct correlation with the number of people committing suicides in that region.

```{r, echo=FALSE}

continents <- unique(data.suicides$continent)
for(cont in continents){
  dat <- data.suicides[which(data.suicides$continent == cont),]
  gdps <- unique(dat$gdp_per_capita)
  gdps <- sort(gdps)
  suicides <- numeric(length = length(gdps))
  counter <- 1
  
  for(i in gdps){
    suicides[counter] <- sum(dat$suicides.100k.pop[which(dat$gdp_per_capita == i)])
    counter <- counter + 1
  }
  
  plot(gdps,suicides,'l', xlab = "GDP per capita", ylab = "No. of Suicides", main = paste("GDP vs. Suicide Rate for", cont))
  }
```

Result: We observe that the GDP per capita has no correlation with the number of suicides per capita.

Remark: Though financial stability on an individual level cannot simply be measured by the per-capita income of a particular region, it still gives us a large scale understanding of the financial states of the residents of a particular region. With a large enough data-set, we can, hence, hope to gauge the general effect of income on the suicide rates.

##### Claim 2: Suicide Rates and Health Issues

From our previous analysis, if we want to compare the trend in GDP per capita vs The happiness index, we observe the following plot.

```{r, echo=FALSE}

dat.happy <- data.happiness[which(data.happiness$Continent == "Europe"),]
plot(dat.happy$Economy..GDP.per.Capita., dat.happy$Happiness.Score,
     xlab = "GDP per Capita",
     ylab = "Happiness Score",
     main = "Europe")
abline(lm(dat.happy$Happiness.Score~dat.happy$Economy..GDP.per.Capita.),col = "red")
legend("bottomright", "Line of Best Fit", fill = "red")
```

We observe that the happiness index is strongly correlated with the GDP per capita as opposed to the trend observed in the suicide rates. We can further substantiate the result by testing this on various continents:

```{r, echo=FALSE}

continents <- unique(data.suicides$continent)
for(cont in continents){
  dat.happy <- data.happiness[which(data.happiness$Continent == cont),]
  plot(dat.happy$Economy..GDP.per.Capita., dat.happy$Happiness.Score,
       xlab = "GDP per Capita",
       ylab = "Happiness Score",
       main = cont)
  abline(lm(dat.happy$Happiness.Score~dat.happy$Economy..GDP.per.Capita.),col = "red")
  legend("bottomright", "Line of Best Fit", fill = "red")
}
```

```{r, echo=FALSE}

dat.happy <- data.happiness[which(data.happiness$Continent == "Europe"),]
plot(dat.happy$Economy..GDP.per.Capita., dat.happy$Health..Life.Expectancy.,
     xlab = "GDP per Capita",
     ylab = "Health Index",
     main = "Europe")
abline(lm(dat.happy$Health..Life.Expectancy.~dat.happy$Economy..GDP.per.Capita.),col = "red")
legend("bottomright", "Line of Best Fit", fill = "red")
```

To further substantiate the fact that we have a strong correlation between Health Index and GPD per Capita, we can look at the correlation between the fitted values and the observed values.

```{r}
cor(dat.happy$Health..Life.Expectancy.,fitted(lm(dat.happy$Health..Life.Expectancy.~dat.happy$Economy..GDP.per.Capita.))) # multiple correlation
```

As expected the correlation values are really high.

```{r, echo=FALSE}

Continents <- unique(data.suicides$continent)
corr.values <- data.frame(Continents)
values <- numeric(length = length(Continents))
counter = 1
for(cont in continents){
  dat.happy <- data.happiness[which(data.happiness$Continent == cont),]
  values[counter] <- (cor(dat.happy$Health..Life.Expectancy.,fitted(lm(dat.happy$Health..Life.Expectancy.~dat.happy$Economy..GDP.per.Capita.)))
  )
  counter <- counter + 1
}
corr.values$`Corr Values`<-values
corr.values
```
